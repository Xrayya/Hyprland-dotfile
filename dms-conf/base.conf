# ==================
# ESSENTIAL ENV
# ==================
# ############ Wayland #############
env = ELECTRON_OZONE_PLATFORM_HINT,auto

######### Applications #########
env = XDG_DATA_DIRS,$HOME/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share

# ############ Themes #############
env = QT_QPA_PLATFORM, wayland;xcb
env = QT_QPA_PLATFORMTHEME, qt6ct
env = GTK_USE_PORTAL=1
env = XDG_MENU_PREFIX, plasma-

env = TERM,kitty -1
env = CHROME_EXECUTABLE, google-chrome-stable

env = XCURSOR_THEME,Bibata-Modern-Classic
env = XCURSOR_SIZE,20
env = HYPRCURSOR_THEME,Bibata-Modern-Classic
env = HYPRCURSOR_SIZE,20

# ==================
# STARTUP APPS
# ==================
exec-once = systemctl --user import-environment QT_QPA_PLATFORMTHEME
exec-once = /usr/lib/polkit-kde-authentication-agent-1
exec-once = hyprsunset
exec-once = hypridle
exec-once = hyprpm reload -n

# ############ Secret Portal: KDE Wallet #############
# REQUIRED; initiate kwallet pam
exec-once = /usr/lib/pam_kwallet_init
# REQUIRED; REQUIRED USING QDBUS6 otherwise it will pop up password modal on startup; open kwallet on login
exec-once = qdbus6 org.kde.kwalletd6 /modules/kwalletd6 org.kde.KWallet.open kdewallet 0 login

exec-once = DMS_DISABLE_POLKIT=1 dms run

# ==================
# DECORATION
# ==================
decoration {
    rounding = 7

    active_opacity = 1.0
    inactive_opacity = 0.98

    shadow {
        enabled = true
        range = 30
        render_power = 5
        offset = 0 5
        color = rgba(00000070)
    }

    blur {
      enabled = true
      size = 9
      passes = 3
      vibrancy = 0.1696
    }
}

# ==================
# INPUT CONFIG
# ==================
input {
    kb_layout = us
    kb_options = altwin:swap_lalt_lwin
    numlock_by_default = true
    touchpad {
        natural_scroll = true
    }
}

gesture = 3, horizontal, workspace

unbind = SUPER, T
unbind = SUPER, X
unbind = , XF86AudioRaiseVolume
unbind = , XF86AudioLowerVolume 
unbind = , XF86MonBrightnessUp
unbind = , XF86MonBrightnessDown
unbind = SUPER, W
unbind = SUPER SHIFT, F
unbind = , Print
unbind = CTRL, Print
unbind = ALT, Print
unbind = SUPER SHIFT, P # it's dangerous for me, MUST UNBIND

bind = SUPER, RETURN, exec, $TERM
bind = SUPER, B, exec, ~/.config/hypr/scripts/open-default-browser.sh
bind = SUPER, E, exec, ~/.config/hypr/scripts/open-default-file-manager.sh

bindm = SUPER, mouse:272, movewindow
bindm = SUPER_CTRL, mouse:272, resizewindow

bind = SUPER_CTRL, N, exec, dms ipc call notifications toggleDoNotDisturb

bind = SUPER, Escape, exec, dms ipc call powermenu toggle

bindel = , XF86AudioRaiseVolume, exec, dms ipc call audio increment 1
bindel = , XF86AudioLowerVolume, exec, dms ipc call audio decrement 1

bindel = , XF86MonBrightnessUp, exec, dms ipc call brightness increment 1 ""
bindel = , XF86MonBrightnessDown, exec, dms ipc call brightness decrement 1 ""

bind = SUPER, W, exec, dms ipc call wallpaper next
bind = SUPER_SHIFT, W, exec, dms ipc call wallpaper pref

bind = SUPER_ALT, F, togglefloating

bind = SUPER, 0, workspace, 10
bind = SUPER SHIFT, 0, movetoworkspace, 10

bind = SUPER_SHIFT, S, exec, grim -g "$(slurp)" -t ppm - | satty --filename - --output-filename ~/Pictures/Screenshots/Screenshot-$(date '+%Y%m%d-%H:%M:%S').png 

layerrule {
  name = blur bar
  match:namespace = dms:bar 
  ignore_alpha = 0.5
  blur = true
  blur_popups = true
}

layerrule {
  name = blur clock widget
  match:namespace = quickshell:desktop-widget:desktopClock.*$
  ignore_alpha = 0.7
  blur = true
  blur_popups = true
}

layerrule {
  name = blur sys mon widget
  match:namespace = quickshell:desktop-widget:systemMonitor.*$
  ignore_alpha = 0.7
  blur = true
  blur_popups = true
}

# ==================
# PLUGINS
# ==================

source = ../conf/plugins/hyprscrolling.conf

# ############ XWayland #############
# Handle xwayland way better than Hyprland's native implementation
source = ../conf/plugins/xwayland-satellite.conf

source = ../conf/windowrules.conf

general:gaps_out = 6
